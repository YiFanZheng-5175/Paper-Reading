>领域：时间序列预测
>发表在：KDD 2025
>模型名字：DUET: ***D***ual Cl***u***stering ***E***nhanced Multivariate ***T***ime Series Forecasting
>文章链接：[DUET: Dual Clustering Enhanced Multivariate Time Series Forecasting](https://arxiv.org/abs/2412.10859)
>代码仓库：[https://github.com/decisionintelligence/TFB](https://github.com/decisionintelligence/TFB)
![](https://picgo-for-paper-reading.oss-cn-beijing.aliyuncs.com/img/20250308232104.png)
# 一、研究背景与问题提出
## 1.1 研究现状
构建 MTSF 方法通常涉及对时间和通道维度上的相关性进行建模。然而，现实世界中的时间序列通常表现出由分布随时间的变化引起的异质时间模式，这种现象被称为时间分布偏移（TDS）。此外，多个通道之间的相关性是复杂且相互交织的 。因此，开发一种能够有效提取异质时间模式和通道依赖性的方法是至关重要但具有挑战性的。具体而言，实现这些目标受到两个主要挑战的阻碍。  
![](https://picgo-for-paper-reading.oss-cn-beijing.aliyuncs.com/img/20250309190903.png)  

首先，由时间依赖的稳定性（TDS）引起的异构时间模式难以建模。在实际应用中，描述不稳定系统的时间序列很容易受到外部因素的影响 。这种时间序列的非平稳性意味着数据分布随时间变化，这种现象称为时间依赖的稳定性（TDS）。TDS 导致时间序列具有不同的时间模式，正式称为时间模式的异质性。例如，图 1 (a) 展示了一个经济领域的时间序列，它显示了随国际环境的变化。我们可以观察到三个区间 A、B 和 C 遵循不同的时间分布，如图 1 (b)、1 (c) 和 1 (d) 所示的数值直方图所证明。这种分布的变化也伴随着不同的时间模式。如图 1 (a) 所示，蓝色区间 A 呈现下降趋势，绿色区间 B 呈现上升趋势，黄色区间 C 呈现更陡峭的下降趋势。考虑到这些模式在时间序列中的普遍存在，将它们纳入考虑至关重要。然而，最近的研究主要以***隐含的方式处理异构时间模式***，这最终会损害预测准确性。  

其次，复杂的通道相互关系很难灵活建模。对于多时间序列预测任务，对不同通道之间的相关性进行建模至关重要，因为特定通道的预测准确性通常可以通过利用来自其他相关通道的信息来提高。例如，在天气预报中，通过结合湿度、风速和气压数据可以提高温度预测的准确性，因为这些因素相互关联，能够提供更全面的天气状况视图。

![](https://picgo-for-paper-reading.oss-cn-beijing.aliyuncs.com/img/20250309191125.png)

研究人员探索了多种管理多通道的策略，包括 1）独立处理每个通道独立通道，CI），2）假设每个通道与所有其他通道相关（依赖通道，CD），以及 3）将通道分组为簇（通道硬聚类，CHC）。

图 2 说明了这三种策略。CI 强加了在不同通道上使用相同模型的约束。虽然它提供了鲁棒性，但它忽略了通道之间的潜在交互，并且在通用性和对未见过的通道的能力方面可能受到限制。另一方面，CD 同时考虑所有通道并生成用于解码的联合表示，但可能容易受到来自不相关通道的噪声的影响，从而降低模型的鲁棒性。CHC 通过硬聚类将多元时间序列划分为不相交的簇，在每个簇内应用 CD 建模方法，在簇之间应用 CI 方法。然而，这种方法仅考虑同一簇内的关系，限制了灵活性和通用性。***总之，目前还没有一种方法能够精确而灵活地对通道之间的复杂交互进行建模。***


# 二、问题剖析与解决策略
## 2.1 解决方法
在这项研究中，我们通过提出一个通用框架 DUET 来应对上述两个挑战，该框架在时间和通道维度上引入双重聚类以增强多元时间序列预测。

首先，为了对由***TDS 引起的异构时间模式进行建模，我们设计了一个时间聚类模块***（TCM）。该模块将时间序列聚类为细粒度分布，使我们能够使用各种模式提取器来捕获其内在时间模式，从而对时间模式的异质性进行建模。这种方法有效地处理了平稳和非平稳数据，显示出强大的通用性。

其次，为了灵活地建模通道之间的关系，我们提出了一个***通道聚类模块***（CCM）。该模块使用通道软聚类策略，通过度量学习在频域中捕获通道之间的关系并应用稀疏化。这种方法使每个通道都能专注于那些对下游预测任务有益的通道，同时减轻噪声或不相关通道的影响，从而实现有效的通道软聚类。最后，基于掩码注意力机制的融合模块（FM）有效地将 TCM 提取的时间特征与 CCM 生成的通道掩码矩阵相结合。

#### 2.1.1 时间聚类模块
![](https://picgo-for-paper-reading.oss-cn-beijing.aliyuncs.com/img/20250309191525.png)
#### 2.1.2 通道聚类模块
![](https://picgo-for-paper-reading.oss-cn-beijing.aliyuncs.com/img/20250309191550.png)

- **可学习距离度量**：从频率度量空间的角度出发，对通道间的相关性进行建模。对于离散时间序列，先使用实快速傅里叶变换（rFFT）将其投影到有限的频率空间，再通过取范数得到特征表示。采用可学习的马氏距离度量，计算通道间的距离，公式为$d(X_{i,:}, X_{j,:}) = (X_{i,:}^{chan} - X_{j,:}^{chan})^T \cdot Q \cdot (X_{i,:}^{chan} - X_{j,:}^{chan})$，其中 $Q$是可学习的半正定矩阵，通过这种方式自适应地探索距离度量，以更好地评估通道相关性，提高预测精度。
- **归一化处理**：计算通道间的关系矩阵并进行归一化，将其映射到 $[0, 1]$区间，公式为$D_{ij} = d(X_{i,:}, X_{j,:})$，$C_{ij} = \begin{cases} \frac{1}{D_{ij}} & \text{if } i \neq j \\ 0 & \text{if } i = j \end{cases}$，$P_{ij} = \begin{cases} \frac{C_{ij} \cdot \gamma}{\max_{j}(C_{ij})} & \text{if } i \neq j \\ 1 & \text{if } i = j \end{cases}$ ，其中 $\gamma$ 是折扣因子，避免绝对连接。这些操作将通道间的关系概率化，$P_{ij}$ 表示通道  $j$对通道 $i$在预测任务中的有用概率。
- **重参数化操作**：为了过滤无关通道的不利影响，保留相关通道的有益影响，对概率矩阵进行伯努利重采样，得到二进制通道掩码矩阵 $M$，其中 $M_{ij} \approx Bernoulli(P_{ij})$。为确保梯度的传播，在伯努利重采样过程中使用Gumbel Softmax重参数化技巧。较高的 $P_{ij}$值会使 $M_{ij}$更接近1，表示通道 $i$和通道 $j$之间存在关系 。

#### 2.1.3 融合模块
![](https://picgo-for-paper-reading.oss-cn-beijing.aliyuncs.com/img/20250309192148.png)
## 2.2 模型结构
![](https://picgo-for-paper-reading.oss-cn-beijing.aliyuncs.com/img/20250308232104.png)
# 三、实验验证与结果分析 
## 3.1 消融实验

![](https://picgo-for-paper-reading.oss-cn-beijing.aliyuncs.com/img/20250309192317.png)

- **w/o TCM**：去除时间聚类模块，观察模型在处理具有不同时间分布变化特征数据集时的性能表现。
- **w/o CCM**：去除通道聚类模块，使模型采用通道独立（CI）策略，观察其在处理具有不同通道相关性数据集时的性能。
- **Full Attention**：用全注意力机制替代掩码注意力机制，让模型采用通道相关（CD）策略，分析在不同通道相关性数据集上的性能变化。
- **Tem-Info**：将通道距离计算从频率域改为时域，探究计算域的改变对模型性能的影响。

## 3.2 不同距离度量方法对DUET模型的影响

![](https://picgo-for-paper-reading.oss-cn-beijing.aliyuncs.com/img/20250309192554.png)

选取欧氏距离（Euclidean distance）、余弦相似度（Cosine similarity）和动态时间规整（DTW，Dynamic Time Warping）这几种非可学习的相似性度量方法，同时还引入随机掩码矩阵作为对比。

## 3.3 分布权重的可视化
![](https://picgo-for-paper-reading.oss-cn-beijing.aliyuncs.com/img/20250309193152.png)  


- **ETTh1数据集**：样本1和样本2呈现出相似的季节性模式，它们的分布权重也较为相似；而样本1、样本3和样本4之间，其分布权重差异明显，反映出它们的分布存在较大不同。这表明模型能够识别出具有相似季节性模式样本在分布上的相似性，同时也能区分出不同分布特征的样本。
- **Weather数据集**：样本3和样本4具有相似的趋势，其分布权重相似；但样本1、样本2和样本3之间分布权重差异较大，说明它们的分布不同。这进一步验证了模型对不同分布样本的区分和聚类能力，即使在同一数据集中，具有不同趋势或特征的样本，模型也能准确识别其分布差异并进行聚类。

## 3.4 通道权重可视化

![](https://picgo-for-paper-reading.oss-cn-beijing.aliyuncs.com/img/20250309193220.png)

从图7中可观察到，具有相似频率分量组合的通道，如部分通道之间的连接权重较高，表明它们可能被聚类到一个软组中。同时，不同组之间的通道也保留了部分相关性，如C6和C3之间存在0.127的注意力权重，这意味着CCM在实现通道聚类时，并非完全割裂不同组通道的联系，而是在最大化邻居信息增益的同时，保留了一定的跨组相关性，使得模型在预测任务中能综合利用更多信息。